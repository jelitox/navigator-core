FROM python:3.8-alpine
LABEL maintainer="javier@javierleon.dev"
ENV PYTHONUNBUFFERED 1
ENV CRYPTOGRAPHY_DONT_BUILD_RUST=1
RUN apk --no-cache --update-cache add \
    openssh-client git make automake \
    gcc gfortran unixodbc unixodbc-dev \
    sqlite-libs python3 libpq libxml2-dev \
    jpeg-dev  postgresql-dev libxslt-dev \
    libffi-dev python3-dev py-pip build-base \
    wget musl-dev  openblas-dev \
    libmemcached-dev rust && \ 
    ln -s /usr/include/locale.h /usr/include/xlocale.h \
    && mkdir -p /home/ubuntu/symbits \
    && mkdir -p /var/log/troc/ 
RUN apk add --no-cache \
    gcc \
    musl-dev && \
    pip install adal==1.2.4 \
    aiocassandra==2.0.1 \
    aiocouch==2.0.1 \
    aiodns==2.0.0 \
    aiofile==3.1.1 \
    aiofiles==0.5.0 \
    aiofluent==1.2.9 \ 
    aioftp==0.18.1 \
    aiohttp==3.7.4 \
    aiohttp-cors==0.7.0 \
    aiohttp-debugtoolbar==0.6.0 \
    aiohttp-jinja2==1.3.0 \
    aiohttp-jrpc==0.1.0 \
    aiohttp-session==2.9.0 \
    aiohttp-sse==2.0.0 \
    aiohttp-swagger==1.0.15 \
    aiohttp-utils==3.1.1 \
    aioimaplib==0.7.18 \
    aioinflux==0.9.0 \
    aiojobs==0.2.2 \
    aiologstash==2.0.0 \
    aiomcache==0.6.0 \
    aioodbc==0.3.3 \
    aiopg==1.0.0 \
    aioprocessing==1.1.0 \
    aioredis==1.3.1 \
    aiosmtplib==1.1.4 \
    aiosocks==0.2.6 \
    aiosqlite==0.15.0 \
    apipkg==1.5 \
    appdirs==1.4.4 \
    APScheduler==3.7.0 \
    aredis==1.1.8 \
    asn1crypto==1.4.0 \
    async-generator==1.10 \
    async-timeout==3.0.1 \
    asyncio==3.4.3  \
    asyncio-redis==0.16.0 \
    asyncpg==0.21.0 \
    asyncssh==2.4.2 \
    attrs==20.2.0 \
    bcrypt==3.2.0 \
    beautifulsoup4==4.9.3 \
    black==20.8b1 \
    boto3==1.16.29 \
    botocore==1.19.29 \
    brotlipy==0.7.0 \
    bs4==0.0.1 \
    cached-property==1.5.2 \
    cachetools==4.2.0 \
    caio==0.6.3 \
    cassandra-driver==3.24.0 \
    cchardet==2.1.7 \
    certifi==2020.12.5 \
    cffi==1.14.4 \
    chardet==3.0.4 \
    ciso8601==2.1.3 \
    click==7.1.2 \
    cloudpickle==1.6.0 \
    configparser==5.0.1 \
    coverage==5.3.1 \
    cryptography==3.4.6 \
    Cython==0.29.21 \
    dask==2.30.0 \
    dateparser==1.0.0 \
    decorator==4.4.2 \
    defusedxml==0.6.0 \
    Deprecated==1.2.10 \
    elasticsearch==7.10.1 \
    et-xmlfile==1.0.1 \
    execnet==1.7.1 \ 
    fido2==0.8.1 \
    fluent-logger==0.9.6 \
    fsspec==0.8.4 \
    geographiclib==1.50 \
    geomet==0.2.1.post1 \
    geopy==2.0.0 \
    gmail==0.6.3 \
    google-api-core==1.24.0 \
    google-api-python-client==1.12.8 \
    google-auth==1.24.0 \
    google-auth-httplib2==0.0.4 \
    googleapis-common-protos==1.52.0 \
    gunicorn==20.0.4 \
    h11==0.12.0 \
    hiredis==1.1.0 \
    html5lib==1.1 \
    httpie==2.3.0 \
    httplib2==0.18.1 \
    httptools==0.1.1 \
    idna==2.10 \
    iniconfig==1.1.1 \
    iso8601==0.1.13 \
    isodate==0.6.0 \
    isort==5.6.4 \
    jdcal==1.4.1 \
    Jinja2==2.11.3 \
    jmespath==0.10.0 \
    joblib==1.0.0 \
    jsonpath-rw==1.4.0 \
    jsonpath-rw-ext==1.2.2 \
    jsonschema==3.2.0 \
    libnacl==1.7.2 \
    limits==1.5.1 \
    LivePopularTimes==1.0 \
    locket==0.2.0 \
    lxml==4.6.2 \
    MarkupSafe==1.1.1 \
    motor==2.3.0 \
    msal==1.9.0 \
    msgpack==0.6.2 \
    msgpack-python==0.5.6 \
    multidict==5.1.0 \
    mypy-extensions==0.4.3 \
    nltk==3.5 \
    numpy==1.19.4 \
    oauth2client==4.1.3 \
    oauthlib==3.1.0 \
    objectpath==0.6.1 \
    Office365-REST-Python-Client==2.3.1 \
    openpyxl==3.0.6 \
    outcome==1.1.0 \
    packaging==20.8 \
    pandas==1.2.1 \
    partd==1.1.0 \
    pathspec==0.8.1 \
    patool==1.12 \
    pbr==5.5.1 \
    PGPy==0.5.3 \
    Pillow==8.0.1 \
    pluggy==0.13.1 \
    ply==3.11 \
    protobuf==3.14.0 \
    psycopg2-binary==2.8.6 \
    py==1.10.0 \
    pyasn1==0.4.8 \
    pyasn1-modules==0.2.8 \
    pycares==3.1.1 \
    pycparser==2.20 \
    pycryptodome==3.9.9 \
    pydantic==1.7.1 \
    PyDrive==1.3.1 \
    Pygments==2.7.4 \
    PyJWT==2.0.1 \
    pylibmc==1.6.1 \
    pylogbeat==2.0.0 \
    pymongo==3.11.2 \
    pyo365==0.1.3 \
    pyodbc==4.0.30 \
    pyparsing==2.4.7 \
    pyrsistent==0.17.3 \
    pyshorteners==1.0.1 \
    PySocks==1.7.1 \
    pytest==6.2.1 \
    pytest-assume==2.4.2 \
    pytest-asyncio==0.14.0 \
    pytest-forked==1.3.0 \
    pytest-xdist==2.1.0 \
    python-dateutil==2.8.1 \
    python-dotenv==0.15.0 \
    python-logstash==0.4.6 \
    python-logstash-async==2.2.0 \
    python-magic==0.4.18 \
    python-mimeparse==1.6.0 \
    python-pkcs11==0.7.0 \
    python-rapidjson==0.9.3 \
    python-telegram-bot==13.3 \
    pytz==2020.4 \
    PyYAML==5.3.1 \
    rapidjson==1.0.0 \
    redis==3.5.3 \
    regex==2020.11.13 \
    Represent==1.6.0 \
    requests==2.25.0 \
    requests-file==1.5.1 \
    requests-oauthlib==1.3.0 \
    requests-toolbelt==0.9.1 \
    rethinkdb==2.4.8 \
    rncryptor==3.3.0 \
    rsa==4.6 \
    s3transfer==0.3.3 \
    six==1.15.0 \
    slixmpp==1.7.0 \
    sockjs==0.11.0 \
    soupsieve==2.1 \
    SQLAlchemy==1.3.20 \
    sqlalchemy-aio==0.160 \
    stringcase==1.2.0 \
    tabulate==0.8.7 \
    telegram==0.0.1 \
    toml==0.10.2 \
    toolz==0.11.1 \
    tornado==6.1 \
    tqdm==4.51.0 \
    tweepy==3.9.0 \
    twilio==6.48.0 \
    typed-ast==1.4.1 \
    typing-extensions==3.7.4.3 \
    tzlocal==2.1 \
    uritemplate==3.0.1 \
    urllib3==1.26.2 \
    uvicorn==0.13.4 \
    uvloop==0.14.0 \
    validictory==1.1.2 \
    watchgod==0.7 \
    webencodings==0.5.1 \
    websockets==8.1 \
    wrapt==1.12.1 \
    xlrd==1.2.0 \
    yapf==0.30.0 \
    yarl==1.6.3 \
    zeep==4.0.0 \
    && pip install -e git+https://github.com/phenobarbital/asyncdb.git@27a5dbabaf5412e09c6352357e5786bd7bfa7ccd#egg=asyncdb&subdirectory=../../../extensions/asyncdb \
    && pip install -e git+https://github.com/m-wrzr/populartimes.git@3d3df3f306b6f65d7cf9f5c9387ea665bdfbf836   \
    && pip install -e git+https://github.com/phenobarbital/NavConfig.git@76bdd9af7db1a4922492169866ce6db975eb92cb#egg=navconfig&subdirectory=../../../extensions/NavConfig \
    && pip install -e git+https://github.com/phenobarbital/navigator-api@10a06b1d69539468da4731dfdb2fdb33b5e0ff09#egg=navigator_api&subdirectory=../../navigator 
    